#!/bin/bash

# filter to replace every occurrence of
# :key: with the emoji associated to 'key'

# emojis from emojipedia.org
declare -A emojis
emojis[smile]=ðŸ˜Š
emojis[grin]=ðŸ˜€
emojis[cry]=ðŸ˜¢
emojis[cryloud]=ðŸ˜­
emojis[wink]=ðŸ˜‰
emojis[laugh]=ðŸ˜‚
emojis[grit]=ðŸ˜¬
emojis[sunglasses]=ðŸ˜Ž
emojis[thumbsup]=ðŸ‘
emojis[thumpsdown]=ðŸ‘Ž
emojis[applause]=ðŸ‘
emojis[check]=âœ”ï¸ 
emojis[fire]=ðŸ”¥
emojis[exclamation]=â—
emojis[hundred]=ðŸ’¯
emojis[tomato]=ðŸ…

toemoji () {
  local file="$1"
  local in="/dev/stdin"
  local out="/dev/stdout"

  if [[ -n "$file" ]]; then
    in="$file"
    out="$(mktemp)"
  fi

  while read -r line; do
    for key in "${!emojis[@]}"; do
      line="${line//:$key:/${emojis[$key]}}"
    done
    echo "$line" >> "$out"
  done < "$in"

  if [[ -n "$file" ]]; then
    cp "$out" "$file"
    rm "$out"
  fi
}

toemoji "$@"
